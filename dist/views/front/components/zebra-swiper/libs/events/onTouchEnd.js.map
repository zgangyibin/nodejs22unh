{"version":3,"sources":["../../../../../../../src/views/front/components/zebra-swiper/libs/events/onTouchEnd.js"],"names":["onTouchEnd","event","swiper","data","touchEventsData","params","touches","rtl","rtlTranslate","slidesGrid","enabled","e","originalEvent","allowTouchCallbacks","emit","isTouched","isMoved","grabCursor","setGrabCursor","startMoving","allowSlideNext","allowSlidePrev","touchEndTime","timeDiff","touchStartTime","allowClick","pathTree","path","composedPath","lastClickTime","destroyed","swipeDirection","diff","currentTranslate","startTranslate","currentPos","followFinger","translate","cssMode","freeMode","stopIndex","groupSize","slidesSizesGrid","i","length","slidesPerGroupSkip","slidesPerGroup","increment","ratio","longSwipesMs","longSwipes","slideTo","activeIndex","longSwipesRatio","shortSwipes","isNavButtonTarget","navigation","target","nextEl","prevEl"],"mappings":"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","file":"onTouchEnd.js","sourcesContent":["import {\r\n\tnow,\r\n\tnextTick\r\n} from '../../shared/utils.js';\r\nexport default function onTouchEnd(event) {\r\n\tconst swiper = this;\r\n\tconst data = swiper.touchEventsData;\r\n\tconst {\r\n\t\tparams,\r\n\t\ttouches,\r\n\t\trtlTranslate: rtl,\r\n\t\tslidesGrid,\r\n\t\tenabled\r\n\t} = swiper;\r\n\tif (!enabled) return;\r\n\tlet e = event;\r\n\tif (e.originalEvent) e = e.originalEvent;\r\n\r\n\tif (data.allowTouchCallbacks) {\r\n\t\tswiper.emit('touch-end', e);\r\n\t}\r\n\r\n\tdata.allowTouchCallbacks = false;\r\n\r\n\tif (!data.isTouched) {\r\n\t\tif (data.isMoved && params.grabCursor) {\r\n\t\t\tswiper.setGrabCursor(false);\r\n\t\t}\r\n\r\n\t\tdata.isMoved = false;\r\n\t\tdata.startMoving = false;\r\n\t\treturn;\r\n\t}\r\n\r\n\r\n\tif (params.grabCursor && data.isMoved && data.isTouched && (swiper.allowSlideNext === true || swiper\r\n\t\t\t.allowSlidePrev === true)) {\r\n\t\tswiper.setGrabCursor(false);\r\n\t}\r\n\r\n\r\n\tconst touchEndTime = now();\r\n\tconst timeDiff = touchEndTime - data.touchStartTime; // Tap, doubleTap, Click\r\n\r\n\tif (swiper.allowClick) {\r\n\t\tconst pathTree = e.path || e.composedPath && e.composedPath();\r\n\t\t// swiper.updateClickedSlide(pathTree && pathTree[0] || e.target);\r\n\t\tswiper.emit('tap click', e);\r\n\r\n\t\tif (timeDiff < 300 && touchEndTime - data.lastClickTime < 300) {\r\n\t\t\tswiper.emit('doubleTap doubleClick', e);\r\n\t\t}\r\n\t}\r\n\r\n\tdata.lastClickTime = now();\r\n\tnextTick(() => {\r\n\t\tif (!swiper.destroyed) swiper.allowClick = true;\r\n\t});\r\n\r\n\tif (!data.isTouched || !data.isMoved || !swiper.swipeDirection || touches.diff === 0 || data.currentTranslate ===\r\n\t\tdata.startTranslate) {\r\n\t\tdata.isTouched = false;\r\n\t\tdata.isMoved = false;\r\n\t\tdata.startMoving = false;\r\n\t\treturn;\r\n\t}\r\n\r\n\tdata.isTouched = false;\r\n\tdata.isMoved = false;\r\n\tdata.startMoving = false;\r\n\tlet currentPos;\r\n\r\n\tif (params.followFinger) {\r\n\t\tcurrentPos = rtl ? swiper.translate : -swiper.translate;\r\n\t} else {\r\n\t\tcurrentPos = -data.currentTranslate;\r\n\t}\r\n\r\n\tif (params.cssMode) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (swiper.params.freeMode && params.freeMode.enabled) {\r\n\t\tswiper.freeMode.onTouchEnd({\r\n\t\t\tcurrentPos\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet stopIndex = 0;\r\n\tlet groupSize = swiper.slidesSizesGrid[0];\r\n\r\n\tfor (let i = 0; i < slidesGrid.length; i += i < params.slidesPerGroupSkip ? 1 : params.slidesPerGroup) {\r\n\t\tconst increment = i < params.slidesPerGroupSkip - 1 ? 1 : params.slidesPerGroup;\r\n\t\tif (typeof slidesGrid[i + increment] !== 'undefined') {\r\n\t\t\tif (currentPos >= slidesGrid[i] && currentPos < slidesGrid[i + increment]) {\r\n\t\t\t\tstopIndex = i;\r\n\t\t\t\tgroupSize = slidesGrid[i + increment] - slidesGrid[i];\r\n\t\t\t}\r\n\t\t} else if (currentPos >= slidesGrid[i]) {\r\n\t\t\tstopIndex = i;\r\n\t\t\tgroupSize = slidesGrid[slidesGrid.length - 1] - slidesGrid[slidesGrid.length - 2];\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tconst ratio = (currentPos - slidesGrid[stopIndex]) / groupSize;\r\n\tconst increment = stopIndex < params.slidesPerGroupSkip - 1 ? 1 : params.slidesPerGroup;\r\n\tif (timeDiff > params.longSwipesMs) {\r\n\t\tif (!params.longSwipes) {\r\n\t\t\tswiper.slideTo(swiper.activeIndex);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (swiper.swipeDirection === 'next') {\r\n\t\t\tif (ratio >= params.longSwipesRatio) swiper.slideTo(stopIndex + increment);\r\n\t\t\telse swiper.slideTo(stopIndex);\r\n\t\t}\r\n\r\n\t\tif (swiper.swipeDirection === 'prev') {\r\n\t\t\tif (ratio > 1 - params.longSwipesRatio) swiper.slideTo(stopIndex + increment);\r\n\t\t\telse swiper.slideTo(stopIndex);\r\n\t\t}\r\n\t} else {\r\n\t\tif (!params.shortSwipes) {\r\n\t\t\tswiper.slideTo(swiper.activeIndex);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst isNavButtonTarget = swiper.navigation && (e.target === swiper.navigation.nextEl || e.target === swiper\r\n\t\t\t.navigation.prevEl);\r\n\r\n\t\tif (!isNavButtonTarget) {\r\n\t\t\tif (swiper.swipeDirection === 'next') {\r\n\t\t\t\tswiper.slideTo(stopIndex + increment);\r\n\t\t\t}\r\n\r\n\t\t\tif (swiper.swipeDirection === 'prev') {\r\n\t\t\t\tswiper.slideTo(stopIndex);\r\n\t\t\t}\r\n\t\t} else if (e.target === swiper.navigation.nextEl) {\r\n\t\t\tswiper.slideTo(stopIndex + increment);\r\n\t\t} else {\r\n\t\t\tswiper.slideTo(stopIndex);\r\n\t\t}\r\n\t}\r\n}\n"]}